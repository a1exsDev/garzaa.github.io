<!DOCTYPE HTML>
<head>
<meta charset="UTF-8">
<title> survey helper </title>
<style>
* {
    font-family:'Roboto', sans-serif;
}
button {
    border-style: none;
    border-radius: 2px;
    background-color: white;
    border-style: solid;
    border-width: 1px;
    color: blue;
}
span {
    color: blue;
}
#clear {
    color: red;
}
#haclalogo {
    margin-left: 0px;
    height: 75px;
}
.arraydiv {
    margin-top: 10px;
    border-style: dashed;
    border-width: 1px;
    border-radius: 3px;
    padding: 2px;
    font-size: 11pt;
    display: inline-block;
}
#education {
    margin-top: 20px;
    border-color: #33CC33;
}
#relationship {
    border-color: salmon;
}
#learnmore {
    border-color: #FF9933;
}
#programs {
    border-color: #66CCFF
}
</style>
</head>

<body>
<img src="http://homeforgoodla.org/wp-content/uploads/2015/01/HACLA.jpg" id="haclalogo">

<h2> The Official* HACLA Survey Wizard </h2>

<ul>
    <li>education (e) - 1, 2, 3, 4, 5</li>
    <li>relationship (r) - 1, 2, 3, 4, 5</li>
    <li>learn more (l) - 1, 2, 3, 4, 5, 6, 7</li>
    <li>programs (p) - 1, 2, 3, 4, 5, 6, 7, 8</li>
</ul>
<br>type <span>e1</span> for middle school, for example, and press <span>enter</span>

<br>
<br>type <span>q</span> to exit the prompt, <span>u</span> to undo the last entry
<br>
<br>
<button onclick="main()">input</button>
<button onclick="writeTotals()">update</button>
<button id="clear" onclick="location.reload()">reset</button>
<br>
<div id="education" class="arraydiv"></div>
<br>
<div id="relationship" class="arraydiv"></div>
<br>
<div id="learnmore" class="arraydiv"></div>
<br>
<div id="programs" class="arraydiv"></div>
<br>
<br>
<br>
<br>
<p style="font-size: 8pt">*made in an office</p>
<script>
    writeTotals();
</script>

<script>
var education = [0, 0, 0, 0, 0];
var relationship = [0, 0, 0, 0, 0];
var learnmore = [0, 0, 0, 0, 0, 0, 0];
var programs = [0, 0, 0, 0, 0, 0, 0, 0];

function clear() {
    location.reload();
}

function writeTotals() {
    document.getElementById("education").innerHTML = getPercents(education);
    document.getElementById("relationship").innerHTML = getPercents(relationship);
    document.getElementById("learnmore").innerHTML = getPercents(learnmore);
    document.getElementById("programs").innerHTML = getPercents(programs);
}

writeTotals();

function getTotal(array) {
    var total = 0;
    for (var i = 0; i < array.length; i++) {
        total += array[i];
    }
    return total;
}

function getPercents(array) {
    var newArray = array.slice();
    var percent;
    var total = getTotal(array);
    for (var i = 0; i < array.length; i++) {
        if (newArray[i] > 0) {
            percent = newArray[i] / total;
            percent = percent * 100;
            newArray[i] += " (" + percent.toFixed(0) + "%)";
        }
    }
    return newArray;
}

function main() {

    var lastEntry;

    function undo(lastEntry) {
        switch (lastEntry[0]) {
            case "e":
                subtractFrom(education, lastEntry);
                break;
            case "r":
                subtractFrom(relationship, lastEntry);
                break;
            case "l":
                subtractFrom(learnmore, lastEntry);
                break;
            case "p":
                subtractFrom(programs, lastEntry);
                break;
        }
    }

    function addTo(array, input) {
        if (input[1] <= array.length) {
            array[parseInt(input[1] - 1, 10)] += 1;
        }
    }

    function subtractFrom(array, input) {
        if (input[1] <= array.length) {
            array[parseInt(input[1] - 1, 10)] -= 1;
        }
    }

    var input;

    while (input != "q") {
        input = prompt("enter a code");
        switch (input[0]) {
            case "e":
                addTo(education, input);
                lastEntry = input;
                break;
            case "r":
                addTo(relationship, input);
                lastEntry = input;
                break;
            case "l":
                addTo(learnmore, input);
                lastEntry = input;
                break;
            case "p":
                addTo(programs, input);
                lastEntry = input;
                break;

                //specials
            case "q":
                writeTotals();
                break;
            case "u":
                undo(lastEntry);
                break;
        }
    }
}
</script>
</body>